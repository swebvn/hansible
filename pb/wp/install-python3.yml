# code: language=ansible

- name: Install Python 3.10 on Centos 6 servers
  hosts: all
  strategy: free
  become: yes
  become_method: sudo

  tasks:
    - name: Check if python3 is installed, if installed ignore other tasks
      ansible.builtin.stat:
        path: /usr/local/bin/python3.10
      register: python3_check

    - name: Upload the python3.10 installation script
      ansible.builtin.copy:
        src: "../scripts/install-python3.sh"
        dest: /tmp/install-python3.sh
        mode: 0755
      when: python3_check.stat.exists == False

    - name: Run the python3.10 installation script
      shell:
        chdir: /tmp
        cmd: chmod +x install-python3.sh && ./install-python3.sh
      when: python3_check.stat.exists == False


